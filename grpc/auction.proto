edition = "2023";

option go_package = "./auction";

service Node {
  rpc Bid(BidRequest) returns (BidResponse) {}
  rpc Result(Void) returns (Outcome) {}
  rpc Ping(Void) returns (Void) {}
  rpc Update(UpdateQuery) returns (Void) {}
  rpc Demote(Void) returns (Void) {}
}

service Frontend {
  rpc Bid(BidRequest) returns (BidResponse) {}
  rpc Result(Void) returns (Outcome) {}
}

service FrontendMaintenance {
  rpc ChangePrimary(Void) returns (Void);
}

message BidRequest {
  int64 senderID = 1;
  uint64 timestamp = 2;
  uint64 amount = 3;
  string requestID = 4;
}

message BidResponse {
  int64 senderID = 1;
  uint64 timestamp = 2;
  eAck ack = 3;
}

enum eAck {
  Exception = 0;
  Fail = 1;
  Success = 2;
}

message Outcome {
  int64 senderID = 1;
  uint64 timestamp = 2;
  uint64 leadingBid = 3;
  int64 leadingID = 4;
  int64 auctionStartTime = 5;
  int64 auctionEndTime = 6;
}

message Void {
  int64 senderID = 1;
  uint64 timestamp = 2;
}

message UpdateQuery {
  Outcome outcome = 1;
  string requestID = 2;
}